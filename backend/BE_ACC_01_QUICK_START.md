# ğŸš€ BE-ACC-01 å¿«é€Ÿå¼€å§‹æŒ‡å—

## âš¡ 5 åˆ†é’Ÿå¿«é€Ÿå¼€å§‹

### å‰ç½®æ¡ä»¶æ£€æŸ¥æ¸…å•
- [ ] Node.js v20+ (`node --version`)
- [ ] pnpm 10+ (`pnpm --version`)
- [ ] PostgreSQL è¿è¡Œä¸­ (`psql -V`)
- [ ] åœ¨ `/srv/rrent/backend` ç›®å½•
- [ ] `.env` æ–‡ä»¶å­˜åœ¨ä¸”é…ç½®æ­£ç¡®

### å¿«é€Ÿå¯åŠ¨ (3 æ­¥)

#### Step 1: å‡†å¤‡ç¯å¢ƒ
```bash
# è¿›å…¥é¡¹ç›®ç›®å½•
cd /srv/rrent/backend

# éªŒè¯ç¯å¢ƒå˜é‡
source .env && echo "âœ“ DATABASE_URL=$DATABASE_URL"

# å®‰è£…ä¾èµ–ï¼ˆå¦‚æœè¿˜æœªå®‰è£…ï¼‰
pnpm install
```

#### Step 2: è¿è¡Œç»Ÿä¸€éªŒæ”¶è„šæœ¬
```bash
# æ‰§è¡Œä¸€é”®éªŒæ”¶
bash tools/verify_be_phase1_all.sh
```

#### Step 3: æŸ¥çœ‹ç»“æœ
```
âœ… æˆåŠŸè¾“å‡º:
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  âœ… BE-Phase1 (BE-0..BE-4) éªŒæ”¶é€šè¿‡
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âŒ å¤±è´¥è¾“å‡º:
âœ— Failed at step: [å…·ä½“æ­¥éª¤åç§°]
æŸ¥çœ‹æ—¥å¿—: cat /tmp/be_phase1_server.log
```

---

## ğŸ“‹ éªŒæ”¶æ­¥éª¤è¯´æ˜

### Step 1: ç¯å¢ƒæ£€æŸ¥ (30 ç§’)
æ£€æŸ¥å¿…è¦çš„ä¾èµ–å’Œç¯å¢ƒå˜é‡æ˜¯å¦å·²å®‰è£…/é…ç½®ã€‚
```bash
âœ“ Node.js ç‰ˆæœ¬
âœ“ pnpm ç‰ˆæœ¬  
âœ“ DATABASE_URL æ˜¯å¦è®¾ç½®
```

### Step 2: Lint å’Œæ„å»º (2-3 åˆ†é’Ÿ)
æ£€æŸ¥ä»£ç è´¨é‡å¹¶ç¼–è¯‘ TypeScriptã€‚
```bash
âœ“ ESLint æ£€æŸ¥
âœ“ TypeScript ç¼–è¯‘
```

### Step 3: Prisma æ“ä½œ (1-2 åˆ†é’Ÿ)
éªŒè¯æ•°æ®åº“ schemaï¼Œæ‰§è¡Œè¿ç§»å’Œç§å­ã€‚
```bash
âœ“ Schema éªŒè¯
âœ“ æ•°æ®åº“è¿ç§»
âœ“ ç§å­æ•°æ®åŠ è½½
```

### Step 4: æœåŠ¡å¯åŠ¨ (20-30 ç§’)
å¯åŠ¨åç«¯æœåŠ¡å¹¶éªŒè¯å¥åº·çŠ¶æ€ã€‚
```bash
âœ“ åå°å¯åŠ¨æœåŠ¡ (pnpm start:dev)
âœ“ å¥åº·æ£€æŸ¥æ¢æµ‹ (/health ç«¯ç‚¹)
```

### Step 5: åŸºç¡€è·¯ç”±éªŒè¯ (10 ç§’)
éªŒè¯åŸºæœ¬çš„ API ç«¯ç‚¹æ˜¯å¦å¯ç”¨ã€‚
```bash
âœ“ GET / 
âœ“ GET /health
âœ“ GET /api
```

### Step 6-7: å¯é€‰è„šæœ¬é›†æˆ (å¯é€‰)
å¦‚æœå­˜åœ¨ç›¸åº”è„šæœ¬ï¼Œè‡ªåŠ¨æ‰§è¡Œé¢å¤–éªŒè¯ã€‚
```bash
âœ“ tools/verify_be2_all.sh (BE-2 æœåŠ¡éªŒæ”¶)
âœ“ tools/verify_auth_smoke.sh (Auth çƒŸå›±éªŒè¯)
```

### Step 8: JWT ä¸šåŠ¡æ¥å£éªŒè¯ (10 ç§’)
æµ‹è¯•å®Œæ•´çš„è®¤è¯æµç¨‹å’Œ JWT ä¿æŠ¤çš„æ¥å£ã€‚
```bash
âœ“ POST /auth/login (åˆ›å»º Token)
âœ“ GET /organizations (ä½¿ç”¨ Token è®¿é—®ä¿æŠ¤æ¥å£)
```

---

## ğŸ”§ å¸¸è§é—®é¢˜å¿«é€Ÿè§£å†³

### Q: "Can't reach database server"
**åŸå› **: PostgreSQL æœªè¿è¡Œ  
**è§£å†³æ–¹æ¡ˆ**:
```bash
# å¯åŠ¨ PostgreSQL
sudo systemctl start postgresql

# æˆ–ä½¿ç”¨ Docker
docker run -d \
  -e POSTGRES_PASSWORD=postgres \
  -e POSTGRES_DB=rrent_dev \
  -p 5432:5432 \
  postgres:15
```

### Q: "Port 3000 already in use"
**åŸå› **: å¦ä¸€ä¸ªè¿›ç¨‹å ç”¨äº†ç«¯å£  
**è§£å†³æ–¹æ¡ˆ**:
```bash
# æŸ¥æ‰¾å ç”¨è¿›ç¨‹
lsof -i :3000

# æ€æ­»è¿›ç¨‹
kill -9 <PID>
```

### Q: "jq is not installed"
**å½±å“**: è„šæœ¬ä¼šé™çº§ä½¿ç”¨åŸºç¡€ JSON è§£æï¼ˆä»å¯æ­£å¸¸å·¥ä½œï¼‰  
**å¯é€‰è§£å†³**:
```bash
# å®‰è£… jqï¼ˆå¯é€‰ï¼Œè„šæœ¬ä»ç„¶å·¥ä½œï¼‰
apt-get install jq  # Linux
brew install jq      # macOS
```

### Q: è„šæœ¬å¡ä½æˆ–è¶…æ—¶
**è§£å†³æ–¹æ¡ˆ**:
```bash
# 1. æŸ¥çœ‹åç«¯æ—¥å¿—
cat /tmp/be_phase1_server.log

# 2. æ‰‹åŠ¨æ¸…ç†åå°è¿›ç¨‹
pkill -f "nest start"

# 3. æ£€æŸ¥ Prisma è¿ç§»çŠ¶æ€
pnpm prisma migrate status

# 4. é‡æ–°è¿è¡Œè„šæœ¬
bash tools/verify_be_phase1_all.sh
```

---

## ğŸ“Š æ€§èƒ½åŸºå‡†

| æ­¥éª¤ | é¢„æœŸæ—¶é—´ | è¯´æ˜ |
|------|--------|------|
| ç¯å¢ƒæ£€æŸ¥ | ~30s | å¿«é€Ÿæ£€æŸ¥ |
| Lint å’Œ Build | 2-3 min | é¦–æ¬¡è¾ƒæ…¢ï¼Œç¼“å­˜åè¾ƒå¿« |
| Prisma æ“ä½œ | 1-2 min | å–å†³äºè¿ç§»å’Œç§å­å¤§å° |
| æœåŠ¡å¯åŠ¨ | 20-30s | ç¼–è¯‘å’Œå¯åŠ¨ |
| API éªŒè¯ | ~20s | HTTP è¯·æ±‚å¾€è¿” |
| **æ€»è€—æ—¶** | **4.5-7 åˆ†é’Ÿ** | é¦–æ¬¡è¿è¡Œå¯èƒ½æ›´é•¿ |

---

## ğŸ’¡ é«˜çº§ç”¨æ³•

### è‡ªå®šä¹‰é…ç½®
```bash
# ä¿®æ”¹ç«¯å£
export BACKEND_PORT=8080
bash tools/verify_be_phase1_all.sh

# è‡ªå®šä¹‰æµ‹è¯•ç”¨æˆ·
export TEST_USER="custom@example.com"
bash tools/verify_be_phase1_all.sh

# ä¿®æ”¹æ•°æ®åº“è¿æ¥
export DATABASE_URL="postgresql://user:pass@host:5432/db"
bash tools/verify_be_phase1_all.sh
```

### å•ç‹¬è¿è¡ŒéªŒè¯æ­¥éª¤
```bash
# åªéªŒè¯ Lint å’Œ Build
pnpm run lint && pnpm run build

# åªéªŒè¯ Prisma
pnpm prisma validate
pnpm prisma migrate deploy
pnpm prisma db seed

# åªå¯åŠ¨æœåŠ¡
pnpm start:dev

# åªè¿è¡Œ Auth çƒŸå›±éªŒè¯
bash tools/verify_auth_smoke.sh
```

### CI/CD é›†æˆ
```bash
# GitHub Actions ç¤ºä¾‹
- name: Run BE Acceptance Tests
  run: |
    cd backend
    source .env
    bash tools/verify_be_phase1_all.sh
```

---

## ğŸ“š æ–‡æ¡£å¯¼èˆª

| æ–‡æ¡£ | ç”¨é€” | ä½•æ—¶æŸ¥çœ‹ |
|------|------|--------|
| **æœ¬æ–‡ä»¶** | å¿«é€Ÿå¼€å§‹ | é¦–æ¬¡è¿è¡Œæ—¶ |
| `QUICK_REFERENCE.md` | è¯¦ç»†é…ç½®è¯´æ˜ | éœ€è¦äº†è§£é…ç½®æ—¶ |
| `BE_ACC_01_IMPLEMENTATION.md` | å®ç°ç»†èŠ‚ | éœ€è¦ä¿®æ”¹è„šæœ¬æ—¶ |
| `BE_ACC_01_FINAL_REPORT.md` | éªŒæ”¶æŠ¥å‘Š | éœ€è¦äº†è§£å®Œæ•´éªŒè¯æ—¶ |
| `BE_COMPLETION_CHECKLIST.md` | å®Œæˆæ¸…å• | é¡¹ç›®äº¤æ¥æ—¶ |

---

## âœ… éªŒæ”¶æˆåŠŸæ ‡å¿—

å½“çœ‹åˆ°ä»¥ä¸‹è¾“å‡ºæ—¶ï¼Œè¡¨ç¤ºéªŒæ”¶å…¨éƒ¨é€šè¿‡ï¼š

```text
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  âœ… BE-Phase1 (BE-0..BE-4) éªŒæ”¶é€šè¿‡
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

æ‰€æœ‰éªŒè¯æ­¥éª¤å·²æˆåŠŸå®Œæˆ:

  âœ“ ç¯å¢ƒæ£€æŸ¥
  âœ“ Lint å’Œæ„å»º
  âœ“ Prisma éªŒè¯ã€è¿ç§»å’Œç§å­
  âœ“ åç«¯æœåŠ¡å¯åŠ¨
  âœ“ åŸºç¡€è·¯ç”±éªŒè¯
  âœ“ BE-2 æœåŠ¡éªŒæ”¶
  âœ“ Auth çƒŸå›±éªŒè¯
  âœ“ å¸¦ JWT çš„ä¸šåŠ¡æ¥å£éªŒè¯

åç«¯é¡¹ç›®å·²å‡†å¤‡å°±ç»ªï¼
```

---

## ğŸ”— ç›¸å…³å‘½ä»¤é€ŸæŸ¥

```bash
# å¼€å‘ç›¸å…³
pnpm install              # å®‰è£…ä¾èµ–
pnpm run lint             # ä»£ç æ£€æŸ¥
pnpm run build            # ç¼–è¯‘ä»£ç 
pnpm start:dev            # å¯åŠ¨å¼€å‘æœåŠ¡

# æ•°æ®åº“ç›¸å…³
pnpm prisma validate      # éªŒè¯ Schema
pnpm prisma migrate dev   # åˆ›å»ºæ–°è¿ç§»
pnpm prisma migrate deploy # éƒ¨ç½²è¿ç§»
pnpm prisma db seed       # åŠ è½½ç§å­æ•°æ®
pnpm prisma studio       # æ‰“å¼€æ•°æ®åº“ GUI

# è„šæœ¬ç›¸å…³
bash tools/verify_be_phase1_all.sh     # ç»Ÿä¸€éªŒæ”¶
bash tools/verify_be2_all.sh           # BE-2 éªŒæ”¶
bash tools/verify_auth_smoke.sh        # Auth çƒŸå›±

# ç”¨æˆ·ç®¡ç†
pnpm ts-node scripts/create-user.ts    # åˆ›å»ºç”¨æˆ·
```

---

## ğŸ¯ ä¸‹ä¸€æ­¥

éªŒæ”¶é€šè¿‡åï¼Œå¯è¿›è¡Œä»¥ä¸‹æ“ä½œï¼š

1. **éƒ¨ç½²åˆ°å¼€å‘ç¯å¢ƒ**
   ```bash
   git add .
   git commit -m "chore: complete BE-ACC-01 acceptance"
   git push origin develop
   ```

2. **éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ**
   - æ›´æ–°ç”Ÿäº§ç¯å¢ƒçš„ `.env` é…ç½®
   - è®¾ç½® CORS_ALLOWED_ORIGINS ä¸ºå®é™…å‰ç«¯åŸŸå
   - éƒ¨ç½² Docker é•œåƒ

3. **è®¾ç½®ç›‘æ§å‘Šè­¦**
   - Rate Limit è§¦å‘å‘Šè­¦
   - CORS å¤±è´¥å‘Šè­¦
   - è®¤è¯å¤±è´¥å‘Šè­¦

4. **æ€§èƒ½ä¼˜åŒ–**
   - ç¼“å­˜ Prisma æŸ¥è¯¢ç»“æœ
   - ä¼˜åŒ– JWT Token å¤§å°
   - è€ƒè™‘ä½¿ç”¨ Redis ç¼“å­˜

---

## ğŸ“ è·å–å¸®åŠ©

é‡åˆ°é—®é¢˜ï¼ŸæŒ‰ä»¥ä¸‹æ­¥éª¤æ’æŸ¥ï¼š

1. ğŸ“– æŸ¥çœ‹æœ¬æ–‡æ¡£çš„"å¸¸è§é—®é¢˜"éƒ¨åˆ†
2. ğŸ“ æŸ¥çœ‹è„šæœ¬è¾“å‡ºçš„é”™è¯¯æ¶ˆæ¯
3. ğŸ” æ£€æŸ¥æ—¥å¿—: `cat /tmp/be_phase1_server.log`
4. ğŸ› æŸ¥çœ‹è„šæœ¬æºç çš„æ³¨é‡Šï¼ˆè¯¦ç»†è¯´æ˜æ¯ä¸€æ­¥ï¼‰
5. ğŸ“‹ å‚è€ƒ `QUICK_REFERENCE.md` çš„è¯Šæ–­ç« èŠ‚

---

**å¿«é€ŸéªŒè¯å‘½ä»¤**:
```bash
cd /srv/rrent/backend && bash tools/verify_be_phase1_all.sh
```

**é¢„æœŸç»“æœ**: æ‰€æœ‰éªŒæ”¶æ­¥éª¤é€šè¿‡ï¼Œæ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯ã€‚

---

**ç‰ˆæœ¬**: 1.0  
**æœ€åæ›´æ–°**: 2024-11-14  
**çŠ¶æ€**: âœ… å¯ç”¨
